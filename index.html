<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ChaynupZine – レコード一覧</title>
<style>
:root{
  --bg:#F6D44A; --ink:#111; --rule:#C8332B; --link:#2E66CC;
  --punk-bg:#C44731; --punk-fg:#fff;
  --reggae-bg:#1E8C4D; --reggae-fg:#fff;
  --metal-bg:#222; --metal-fg:#fff;
  --rock-bg:#2E66CC; --rock-fg:#fff;
  --hardrock-bg:#8B0000; --hardrock-fg:#fff;
  --pubrock-bg:#A0522D; --pubrock-fg:#fff;
  --powerpop-bg:#FF9900; --powerpop-fg:#fff;
  --other-bg:#888; --other-fg:#fff;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,"Noto Sans JP","Hiragino Sans",sans-serif}
header{padding:20px 16px 8px}
h1{margin:0;font-size:28px;letter-spacing:.05em;font-weight:900}
.desc{color:#333;margin:6px 0 0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;padding:16px}
.card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 3px 12px rgba(0,0,0,.08);cursor:pointer;display:flex;flex-direction:column}
.thumb{aspect-ratio:1/1;background:#ddd;object-fit:cover;width:100%}
.box{padding:12px 12px 14px}
.badge{display:inline-block;border-radius:999px;padding:4px 10px;font-size:12px;font-weight:700;margin-bottom:8px}
.title{font-weight:800;font-size:16px;margin:2px 0 6px}
.meta{font-size:12px;color:#555}
a{color:var(--link);text-decoration:none}
footer{padding:16px 16px 28px;color:#333}
.badge.punk{background:var(--punk-bg);color:var(--punk-fg)}
.badge.reggae{background:var(--reggae-bg);color:var(--reggae-fg)}
.badge.metal{background:var(--metal-bg);color:var(--metal-fg)}
.badge.rock{background:var(--rock-bg);color:var(--rock-fg)}
.badge.hardrock{background:var(--hardrock-bg);color:var(--hardrock-fg)}
.badge.pubrock{background:var(--pubrock-bg);color:var(--pubrock-fg)}
.badge.powerpop{background:var(--powerpop-bg);color:var(--powerpop-fg)}
.badge.other{background:var(--other-bg);color:var(--other-fg)}
</style>
</head>
<body>
<header>
  <h1>ChaynupZine</h1>
  <p class="desc">レコード紹介の全件一覧</p>
</header>

<section class="grid" id="list"></section>

<footer>© ChaynupZine</footer>

<script>
const https://script.google.com/macros/s/AKfycbw83agO_CwQfLKJkkUWllB4UnifRJqpr_ezC6oClpuAV2kG93KXimInmbpb6ppqMj2i1g/exec?api=debug

const genreClass = g => {
  const key = (g||"").toLowerCase();
  if(key.includes("パンク")||key.includes("punk")) return "punk";
  if(key.includes("レゲエ")||key.includes("reggae")) return "reggae";
  if(key.includes("メタル")||key.includes("metal")) return "metal";
  if(key.includes("ハードロック")) return "hardrock";
  if(key.includes("パブロック")) return "pubrock";
  if(key.includes("パワーポップ")||key.includes("power")) return "powerpop";
  if(key.includes("ロック")||key.includes("rock")) return "rock";
  return "other";
};

const byInitial = name => (name||"").replace(/^the\s+/i,"").trim();

const listEl = document.getElementById("list");

fetch(API)
  .then(r=>r.json())
  .then(rows=>{
    rows
      .sort((a,b)=>byInitial(a.band).localeCompare(byInitial(b.band)))
      .forEach((row,i)=>{
        const id = row.id ?? i;
        const img = row.image || "";
        const gClass = genreClass(row.genre);
        const card = document.createElement("article");
        card.className = "card";
        card.onclick = ()=>location.href = `home.html?id=${encodeURIComponent(id)}`;
        card.innerHTML = `
          <img class="thumb" src="${img || 'https://placehold.co/600x600?text=No+Image'}" alt="">
          <div class="box">
            <span class="badge ${gClass}">${row.genre||'その他'}</span>
            <div class="title">${row.band||'Unknown'}</div>
            <div class="meta">${row.country||''}</div>
          </div>
        `;
        listEl.appendChild(card);
      });
  })
  .catch(err=>{
    listEl.innerHTML = `<p>読み込みに失敗しました。${String(err)}</p>`;
  });
</script>
</body>
</html>
